{% extends "stampo.htm" %}
{% block title %}Dashboard - Condivisione{% endblock %}
{% block content %}
    <div class="jumbotron">
        <h1 class="display-3">{% if utente.tipo == 0 %}Ciao, {{ utente.nome }}!{% elif utente.tipo == 1 %} Ciao, peer
            {{ utente.nome }}! {% elif utente.tipo == 2 %}Salve, Admin {{ utente.cognome }}.{% endif %}</h1>
        <p class="lead"> {% if utente.tipo == 2 %} Le {% else %}Ti{% endif %} diamo il benvenuto nella {% if utente.tipo == 2 %} sua {% else %}tua{% endif %} dashboard!</p>
        <hr class="my-4">
        <p>{% if utente.tipo == 0 %}In questa pagina potrai esplorare i corsi sulla piattaforma, visualizzare i tuoi
            impegni e modificare il tuo profilo.{% elif utente.tipo == 1 %}In questa pagina potrai esplorare e creare
            corsi, visualizzare i tuoi impegni e modificare il tuo profilo.{% elif utente.tipo == 2 %}Da questa pagina
            le sarà possibile abilitare gli utenti all'insegnamento, controllare i corsi ed eliminare
            utenti.{% endif %}</p>
    </div>
    {% if utente.tipo > 0 %}
    <ul class="list-group" width=100%>
        <li class="list-group-item"><a href="/notifiche">{% if utente.notifiche > 0 %}{% if utente.notifiche < 1 %}C'è{% else %}Ci sono{% endif %} {{ utente.notifiche }} nuov{% if utente.notifiche > 1 %}e{% else %}a{% endif %} richiest{% if utente.notifiche > 1 %}e{% else %}a{% endif %} di ripetizione!{% else %}Nessuna nuova richiesta di ripetizione{% endif %}</a></li>
    </ul>
    {% endif %}
    <br>
    <div class="row">
            <div class="col-md-8">
                <div id="accordion" role="tablist" class="fg-primary">
                    <div class="card card-d">
                        <div class="card-header card-header-d" role="tab" id="headingOne">
                            <h5 class="mb-0">
                                <a data-toggle="collapse" href="#collapseOne" aria-expanded="true"
                                   aria-controls="collapseOne">
                                    Messaggi di sistema
                                </a>
                            </h5>
                        </div>

                        <div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne"
                             data-parent="#accordion">
                            <div class="card-body card-body-d-m">
                                {% for messaggio in messaggi %}
                                    <div class="alert alert-{% if messaggio.tipo == 1 %}success{% elif messaggio.tipo == 2 %}primary{% elif messaggio.tipo == 3 %}danger{% endif %}" role="alert">
                                        <div class="row">
                                            <div class="col-md-11">
                                                {{ messaggio.testo }}<br>{{ messaggio.data }}
                                            </div>
                                            <div class="col-md-1">
                                                {% if utente.tipo == 2 %}
                                                    <a href="/message_del/{{ messaggio.mid }}" class="alert-link"><i class="fa fa-times" aria-hidden="true"></i></a>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="card card-d">
                        <div class="card-header card-header-d" role="tab" id="headingTwo">
                            <h5 class="mb-0">
                                <a class="collapsed" data-toggle="collapse" href="#collapseTwo" aria-expanded="false"
                                   aria-controls="collapseTwo">
                                    Impegni
                                </a>
                            </h5>
                        </div>
                        <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo"
                             data-parent="#accordion">
                            <div class="card-body card-body-d-m">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Materia</th>
                                            <th>Peer</th>
                                            <th>Data</th>
                                        </tr>
                                    </thead>
                                        {% for impegno in impegni %}
                                            {% if impegno.status == 1 %}
                                            <tr>
                                                <td>{{ impegno.materia }}</td>
                                                <td>{{ impegno.peer }}</td>
                                                <td>{{ impegno.appuntamento }}</td>
                                            </tr>
                                            {% endif %}
                                        {% endfor %}
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="card card-d">
                        <div class="card-header card-header-d" role="tab" id="headingThree">
                            <h5 class="mb-0">
                                <a class="collapsed" data-toggle="collapse" href="#collapseThree" aria-expanded="false"
                                   aria-controls="collapseThree">
                                    Corsi
                                </a>
                            </h5>
                        </div>
                        <div id="collapseThree" class="collapse" role="tabpanel" aria-labelledby="headingThree"
                             data-parent="#accordion">
                            <div class="card-body card-body-d-d">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Materia</th>
                                            <th>Peer</th>
                                            <th>Argomenti</th>
                                            <th>Iscriviti</th>
                                        </tr>
                                    </thead>
                                    {% for corso in corsi %}
                                        <tr>
                                            <td>{{ corso.materia.nome }} - {{ corso.materia.professore }}</td>
                                            <td> <a href="/user_inspect/{{ corso.pid }}"><i class="fa fa-search" aria-hidden="true"></i></a></td>
                                            <td>{{ corso.argomenti }}</td>
                                            <td>{% if corso.pid == utente.uid %} <a href="/corso_del/{{ corso.cid }}"><i class="fa fa-ban" aria-hidden="true"></i></a>  {% elif utente.tipo==2 %} <a href="/corso_del/{{ corso.cid }}"><i class="fa fa-ban" aria-hidden="true"></i></a> {% else %} <a href="/corso_join/{{ corso.cid }}"><i class="fa fa-sign-in" aria-hidden="true"></i></a> {% endif %}</td>
                                        </tr>
                                    {% endfor %}
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <a href="/user_edit/{{ utente.uid }}" type="button" class="btn btn-secondary btn-lg btn-block">Modifica il profilo</a>
                <a href="/informazioni" type="button" class="btn btn-secondary btn-lg btn-block">Informazioni</a>
                {% if utente.tipo > 0 %}
                    <a href="/corso_add" type="button" class="btn btn-info btn-lg btn-block">Crea un corso</a>
                    {% if utente.tipo > 1 %}
                        <a href="/user_list" type="button" class="btn btn-warning btn-lg btn-block">Gestisci utenti</a>
                        <a href="/materia_list" type="button" class="btn btn-warning btn-lg btn-block">Gestisci materie</a>
                        <a href="/message_add" type="button" class="btn btn-warning btn-lg btn-block">Crea messaggio di sistema</a>
                    {% endif %}
                {% endif %}
            </div>
        </div>
{% endblock %}